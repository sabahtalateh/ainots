# Упрощение рациональной дроби

## Задача

Упростить выражение:

$$\frac{x^3 + x^2 - x - 1}{x^2 + 2x + 1}$$

## Решение

### Шаг 1: Факторизуем знаменатель

$$x^2 + 2x + 1 = (x+1)^2$$

Это полный квадрат.

### Шаг 2: Факторизуем числитель

$$x^3 + x^2 - x - 1$$

Сгруппируем члены:

$$= x^2(x+1) - 1(x+1)$$

Вынесем общий множитель $(x+1)$:

$$= (x+1)(x^2-1)$$

Разложим разность квадратов $x^2 - 1$:

$$= (x+1)(x-1)(x+1)$$

$$= (x-1)(x+1)^2$$

### Шаг 3: Сокращаем дробь

$$\frac{x^3 + x^2 - x - 1}{x^2 + 2x + 1} = \frac{(x-1)(x+1)^2}{(x+1)^2} = x-1$$

## Ответ

$$x - 1, \quad x \neq -1$$

**Важно:** При $x = -1$ исходное выражение не определено (деление на ноль).

---

## Проверка в SymPy

```python
from sympy import symbols, simplify, factor, cancel

x = symbols('x')
expr = (x**3 + x**2 - x - 1) / (x**2 + 2*x + 1)

# Способ 1: Упрощение
print(simplify(expr))  # x - 1

# Способ 2: Сокращение дроби
print(cancel(expr))    # x - 1

# Факторизация числителя
print(factor(x**3 + x**2 - x - 1))  # (x - 1)*(x + 1)**2

# Факторизация знаменателя
print(factor(x**2 + 2*x + 1))       # (x + 1)**2
```

---

# Метод Кардано для кубических уравнений

## Вывод формулы Кардано

Рассмотрим уравнение $x^3 - 3x - q = 0$ или $x^3 = 3x + q$.

### Идея метода

Будем искать решение в виде **суммы двух неизвестных**:

$$x = u + v$$

где $u$ и $v$ — пока неизвестные величины, которые мы подберем специальным образом.

### Шаг 1: Раскрытие куба суммы

Подставим $x = u + v$ в уравнение. Вспомним формулу куба суммы:

$$(u + v)^3 = u^3 + 3u^2v + 3uv^2 + v^3$$

Вынесем $3uv$ за скобку из средних членов:

$$(u + v)^3 = u^3 + v^3 + 3uv(u + v)$$

Поскольку $x = u + v$, получаем:

$$x^3 = u^3 + v^3 + 3uvx$$

### Шаг 2: Перестановка слагаемых

Перепишем в виде:

$$x^3 = 3uvx + (u^3 + v^3)$$

### Шаг 3: Метод неопределенных коэффициентов (сравнение коэффициентов)

У нас есть **два выражения для $x^3$**, которые должны быть равны:

**Исходное уравнение:**
$$x^3 = 3x + q$$

**Наше выражение (после подстановки $x = u + v$):**
$$x^3 = 3uvx + (u^3 + v^3)$$

#### Подробное объяснение метода сравнения коэффициентов

Если два многочлена равны **при любом** значении переменной, то **коэффициенты при одинаковых степенях** должны быть равны.

**Перепишем оба уравнения в стандартном виде** (по убыванию степеней):

Исходное:
$$x^3 = \underbrace{0 \cdot x^2}_{\text{нет } x^2} + \underbrace{3}_{\text{коэфф. при } x} \cdot x + \underbrace{q}_{\text{свободный член}}$$

Наше:
$$x^3 = \underbrace{0 \cdot x^2}_{\text{нет } x^2} + \underbrace{3uv}_{\text{коэфф. при } x} \cdot x + \underbrace{u^3 + v^3}_{\text{свободный член}}$$

#### Сравниваем коэффициенты

Поскольку обе части равны, **соответствующие коэффициенты должны совпадать**:

**1) Коэффициент при $x^2$:** 
$$0 = 0 \quad \checkmark \text{ (выполнено автоматически)}$$

**2) Коэффициент при $x^1$ (то есть при $x$):**
$$3uv = 3$$
$$\Rightarrow uv = 1$$

**3) Свободный член (коэффициент при $x^0$):**
$$u^3 + v^3 = q$$

#### Аналогия

Это как если бы у вас было:
$$5x + 7 = Ax + B$$

Чтобы это равенство было верно при **любом** $x$, необходимо:
- $A = 5$ (коэффициенты при $x$ равны)
- $B = 7$ (свободные члены равны)

### Шаг 4: Система уравнений

Получаем систему из двух уравнений для определения $u$ и $v$:

$$\begin{cases}
uv = 1 \\
u^3 + v^3 = q
\end{cases}$$

Или эквивалентно:

$$\begin{cases}
u^3 + v^3 = q \\
u^3 v^3 = 1
\end{cases}$$

(второе уравнение получено возведением $uv = 1$ в куб)

### Шаг 5: Решение системы

Обозначим $t_1 = u^3$ и $t_2 = v^3$. Тогда:

$$\begin{cases}
t_1 + t_2 = q \\
t_1 \cdot t_2 = 1
\end{cases}$$

Это **теорема Виета**: $t_1$ и $t_2$ являются корнями квадратного уравнения:

$$t^2 - qt + 1 = 0$$

Решая, получаем:

$$t_{1,2} = \frac{q \pm \sqrt{q^2 - 4}}{2}$$

Следовательно:

$$u = \sqrt[3]{\frac{q + \sqrt{q^2 - 4}}{2}}, \quad v = \sqrt[3]{\frac{q - \sqrt{q^2 - 4}}{2}}$$

И решение исходного уравнения:

$$x = u + v = \sqrt[3]{\frac{q + \sqrt{q^2 - 4}}{2}} + \sqrt[3]{\frac{q - \sqrt{q^2 - 4}}{2}}$$

## Почему получилась система из двух уравнений?

**Объяснение:** Мы ввели **две неизвестные** ($u$ и $v$) вместо одной ($x$), поэтому нужно **два условия** для их определения:

1. **Первое условие** ($uv = 1$) — мы выбираем **произвольно**, чтобы коэффициенты совпали
2. **Второе условие** ($u^3 + v^3 = q$) — возникает из **свободного члена** исходного уравнения

Это гениальная идея Кардано: добавить степень свободы (второе неизвестное), а затем использовать её для упрощения задачи!

